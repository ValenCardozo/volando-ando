{% extends 'base.html' %}

{% load i18n %}

{% block title %}{% trans "Volando Ando - Reserva tu vuelo" %}{% endblock %}

{% block content %}
<div class="container py-5">
    {% if not user.is_authenticated %}
    <div class="jumbotron bg-light shadow-sm">
        <h1 class="display-4">{% trans "Bienvenido a Volando Ando" %}</h1>
        <p class="lead">{% trans "Tu plataforma para encontrar y reservar los mejores vuelos a los precios más competitivos." %}</p>
        <hr class="my-4">
        <div class="row">
            <div class="col-md-6">
                <div class="card mb-3">
                    <div class="card-body">
                        <h3 class="card-title">{% trans "¿Qué ofrecemos?" %}</h3>
                        <ul class="list-unstyled">
                            <li><i class="fas fa-plane-departure mr-2 text-primary"></i>{% trans "Amplia selección de vuelos nacionales e internacionales" %}</li>
                            <li><i class="fas fa-tags mr-2 text-primary"></i>{% trans "Precios competitivos y ofertas exclusivas" %}</li>
                            <li><i class="fas fa-clock mr-2 text-primary"></i>{% trans "Reservas rápidas y seguras" %}</li>
                            <li><i class="fas fa-medal mr-2 text-primary"></i>{% trans "Mejor servicio al cliente" %}</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <div class="card-body">
                        <h3 class="card-title">{% trans "Comienza ahora mismo" %}</h3>
                        <p>{% trans "Crea una cuenta o inicia sesión para acceder a todas las funcionalidades:" %}</p>
                        <div class="d-flex mt-4">
                            <a class="btn btn-primary btn-lg mr-3" href="{% url 'login' %}" role="button">{% trans "Iniciar Sesión" %}</a>
                            <a class="btn btn-outline-primary btn-lg" href="{% url 'register' %}" role="button">{% trans "Registrarse" %}</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% else %}
    <div class="row mb-5">
        <div class="col-12">
            <div class="jumbotron bg-light shadow-sm">
                <h1 class="display-4">{% trans "¡Hola" %}, {{ user.username }}!</h1>
                <p class="lead">{% trans "¿A dónde te gustaría viajar hoy?" %}</p>
            </div>
        </div>
    </div>
    
    <div class="row mb-4">
        <div class="col-12">
            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0">{% trans "Buscar Vuelos" %}</h4>
                </div>
                <div class="card-body">
                    <form class="row" method="get" action="">
                        <div class="col-md-4 mb-3">
                            <label for="origin">{% trans "Origen" %}</label>
                            <input type="text" class="form-control" id="origin" name="origin" placeholder="{% trans 'Ciudad de origen' %}" required>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="destination">{% trans "Destino" %}</label>
                            <input type="text" class="form-control" id="destination" name="destination" placeholder="{% trans 'Ciudad de destino' %}" required>
                        </div>
                        
                        <div class="col-md-4 mb-3">
                            <label class="d-block">{% trans "Tipo de viaje" %}</label>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="trip_type" id="roundtrip" value="roundtrip" checked>
                                <label class="form-check-label" for="roundtrip">{% trans "Ida y vuelta" %}</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="trip_type" id="oneway" value="oneway">
                                <label class="form-check-label" for="oneway">{% trans "Solo ida" %}</label>
                            </div>
                        </div>
                        
                        <div class="col-md-3 mb-3">
                            <label for="departure_date">{% trans "Fecha de ida" %}</label>
                            <input type="date" class="form-control" id="departure_date" name="departure_date" required>
                        </div>
                        <div class="col-md-3 mb-3" id="return_date_container">
                            <label for="return_date">{% trans "Fecha de vuelta" %}</label>
                            <input type="date" class="form-control" id="return_date" name="return_date">
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="passengers">{% trans "Pasajeros" %}</label>
                            <select class="form-control" id="passengers" name="passengers">
                                {% for i in '123456'|make_list %}
                                <option value="{{ i }}">{{ i }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="class">{% trans "Clase" %}</label>
                            <select class="form-control" id="class" name="class">
                                <option value="economy">{% trans "Económica" %}</option>
                                <option value="premium">{% trans "Premium" %}</option>
                                <option value="business">{% trans "Business" %}</option>
                            </select>
                        </div>
                        
                        <div class="col-12 text-center mt-2">
                            <button type="submit" class="btn btn-primary btn-lg">{% trans "Buscar Vuelos" %}</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <div class="row">
        <div class="col-md-4 mb-3">
            <div class="card shadow-sm h-100">
                <div class="card-body text-center">
                    <i class="fas fa-ticket-alt fa-3x text-primary mb-3"></i>
                    <h4>{% trans "Mis Vuelos" %}</h4>
                    <p>{% trans "Accede a tus reservas y tickets" %}</p>
                    <a href="" class="btn btn-outline-primary">{% trans "Ver Mis Vuelos" %}</a>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="card shadow-sm h-100">
                <div class="card-body text-center">
                    <i class="fas fa-map-marked-alt fa-3x text-primary mb-3"></i>
                    <h4>{% trans "Destinos Populares" %}</h4>
                    <p>{% trans "Descubre nuevos lugares para visitar" %}</p>
                    <a href="" class="btn btn-outline-primary">{% trans "Explorar Destinos" %}</a>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="card shadow-sm h-100">
                <div class="card-body text-center">
                    <i class="fas fa-percentage fa-3x text-primary mb-3"></i>
                    <h4>{% trans "Ofertas Especiales" %}</h4>
                    <p>{% trans "No te pierdas nuestras mejores promociones" %}</p>
                    <a href="" class="btn btn-outline-primary">{% trans "Ver Ofertas" %}</a>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        const onewayRadio = document.getElementById('oneway');
        const roundtripRadio = document.getElementById('roundtrip');
        const returnDateContainer = document.getElementById('return_date_container');
        const returnDate = document.getElementById('return_date');
        
        // Función para actualizar el estado del campo de fecha de vuelta
        function updateReturnDate() {
            if (onewayRadio.checked) {
                returnDateContainer.style.opacity = '0.5';
                returnDate.disabled = true;
                returnDate.required = false;
            } else {
                returnDateContainer.style.opacity = '1';
                returnDate.disabled = false;
                returnDate.required = true;
            }
        }
        
        // Configuración inicial
        updateReturnDate();
        
        // Escuchar cambios en los radio buttons
        onewayRadio.addEventListener('change', updateReturnDate);
        roundtripRadio.addEventListener('change', updateReturnDate);
        
        // Establecer fechas mínimas para hoy
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('departure_date').setAttribute('min', today);
        document.getElementById('return_date').setAttribute('min', today);
        
        // Actualizar la fecha mínima de retorno cuando se cambia la fecha de ida
        document.getElementById('departure_date').addEventListener('change', function() {
            document.getElementById('return_date').setAttribute('min', this.value);
        });
    });
</script>
{% endblock %}